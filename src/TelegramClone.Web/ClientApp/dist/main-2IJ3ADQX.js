import{a as pe,b as z,c as he,f as fe,g as ge,h as Ce}from"./chunk-IEYFNZVO.js";import{A as M,Ba as de,Ca as A,Ea as ce,Fa as me,Ga as ue,H as m,Ha as N,I as p,K as Y,L as V,M as F,N as y,O as a,P as o,Q as c,R as I,S as U,T as w,U as T,W as g,Y as d,Z as W,_ as Z,aa as q,ba as K,ca as u,da as D,ea as E,ia as X,j as v,ja as ee,k as h,ka as te,l as f,na as ie,oa as ne,p as b,pa as re,qa as k,sa as ae,ta as R,v as O,w as l,x as P,xa as oe,ya as le,za as se}from"./chunk-X5AKF7Z7.js";import{a as H,b as Q}from"./chunk-3RHWOS5U.js";function we(i,t){i&1&&(a(0,"div",1)(1,"div",2)(2,"div",3),c(3,"i",4),o(),c(4,"div",5),o()())}function ke(i,t){i&1&&c(0,"router-outlet")}var B=class i{constructor(){this.themeService=v(z);this.auth=v(N);this.signalR=v(he);P(async()=>{this.themeService.init(),await this.auth.initialize(),this.auth.isAuthenticated()&&await this.signalR.start()})}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=M({type:i,selectors:[["app-root"]],decls:3,vars:1,consts:[[1,"h-screen","w-screen","overflow-hidden","relative","bg-white","dark:bg-telegram-surface"],[1,"h-full","w-full","flex","items-center","justify-center",2,"background","var(--tg-bg)"],[1,"text-center"],[1,"w-16","h-16","rounded-full","mx-auto","mb-4","flex","items-center","justify-center",2,"background","var(--tg-primary)"],[1,"ph","ph-telegram-logo","text-3xl","text-white"],[1,"w-8","h-8","border-3","border-t-transparent","rounded-full","animate-spin","mx-auto",2,"border-color","var(--tg-primary)","border-top-color","transparent"]],template:function(e,n){e&1&&(a(0,"div",0),m(1,we,5,0,"div",1)(2,ke,1,0,"router-outlet"),o()),e&2&&(l(),p(n.auth.isLoading()?1:2))},dependencies:[de],encapsulation:2})}};function Se(i,t){i&1&&(I(0,"div",0),w(1,"div",3),I(2,"div",4)(3,"div",5),w(4,"div",6)(5,"div",7),U(),w(6,"div",8),U()())}function Te(i,t){i&1&&(I(0,"div",1)(1,"div",9),w(2,"div",10),U(),I(3,"div",11),w(4,"div",12),U(),I(5,"div",13),w(6,"div",14),U()())}function Ee(i,t){i&1&&w(0,"div",2)}var j=class i{constructor(){this.variant=ae("chat-item")}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=M({type:i,selectors:[["app-skeleton-loader"]],inputs:{variant:[1,"variant"]},decls:3,vars:1,consts:[[1,"flex","items-center","gap-3","px-4","py-3"],[1,"flex","flex-col","gap-3","p-4"],[1,"w-12","h-12","rounded-full","shimmer-bg","bg-gray-200","dark:bg-gray-800"],[1,"w-12","h-12","rounded-full","shimmer-bg","bg-gray-200","dark:bg-gray-800","shrink-0"],[1,"flex-1","space-y-2"],[1,"flex","justify-between"],[1,"h-4","w-28","rounded","shimmer-bg","bg-gray-200","dark:bg-gray-800"],[1,"h-3","w-12","rounded","shimmer-bg","bg-gray-200","dark:bg-gray-800"],[1,"h-3.5","w-48","rounded","shimmer-bg","bg-gray-200","dark:bg-gray-800"],[1,"self-start","w-3/5"],[1,"h-12","rounded-2xl","rounded-bl-sm","shimmer-bg","bg-gray-200","dark:bg-gray-800"],[1,"self-end","w-2/5"],[1,"h-10","rounded-2xl","rounded-br-sm","shimmer-bg","bg-gray-200","dark:bg-gray-800"],[1,"self-start","w-1/2"],[1,"h-14","rounded-2xl","rounded-bl-sm","shimmer-bg","bg-gray-200","dark:bg-gray-800"]],template:function(e,n){if(e&1&&m(0,Se,7,0,"div",0)(1,Te,7,0,"div",1)(2,Ee,1,0,"div",2),e&2){let r;p((r=n.variant())==="chat-item"?0:r==="message-bubble"?1:r==="avatar"?2:-1)}},encapsulation:2})}};var Le=["listContainer"],Me=["profileTrigger"],Ie=["profileAvatarInput"],ve=(i,t)=>t.id;function Ue(i,t){if(i&1&&c(0,"img",10),i&2){let e=d();y("src",e.chatService.currentUser().avatarUrl,O)}}function De(i,t){if(i&1&&(a(0,"div",11),u(1),o()),i&2){let e=d();l(),E(" ",e.currentUserInitial()," ")}}function Ae(i,t){i&1&&c(0,"app-skeleton-loader",24)}function Ne(i,t){if(i&1&&V(0,Ae,1,0,"app-skeleton-loader",24,Y),i&2){let e=d();F(e.skeletonItems)}}function Pe(i,t){i&1&&(a(0,"div",25)(1,"span",26),u(2,"Pinned"),o()())}function Ve(i,t){i&1&&c(0,"div",27)}function Fe(i,t){i&1&&c(0,"i",33)}function Re(i,t){i&1&&c(0,"i",34)}function ze(i,t){i&1&&c(0,"i",37)}function Be(i,t){i&1&&(a(0,"span",40),u(1,"typing "),a(2,"span",44),c(3,"span",45)(4,"span",46)(5,"span",47),o()())}function je(i,t){i&1&&(a(0,"span",48),u(1,"You:"),o())}function $e(i,t){if(i&1&&(a(0,"span",49),u(1),o()),i&2){d();let e=te(0);l(),E("",e.split(" ")[0],":")}}function He(i,t){if(i&1&&(X(0),m(1,$e,2,1,"span",49)),i&2){let e,n=d(2).$implicit,r=ee((e=d(2).chatService.getUserById((n.lastMessage==null?null:n.lastMessage.senderId)||""))==null?null:e.name);l(),p(r?1:-1)}}function Qe(i,t){if(i&1&&(m(0,je,2,0,"span",48)(1,He,2,2),u(2)),i&2){let e=d().$implicit,n=d(2);p((e.lastMessage==null?null:e.lastMessage.senderId)===n.chatService.currentUser().id?0:e.type==="group"||e.type==="channel"?1:-1),l(2),E(" ",e.lastMessage!=null&&e.lastMessage.voice?"\u{1F3A4} Voice Message":(e.lastMessage==null?null:e.lastMessage.text)||"No messages yet"," ")}}function Oe(i,t){i&1&&c(0,"i",42)}function qe(i,t){if(i&1&&(a(0,"span",43),u(1),o()),i&2){let e=d().$implicit;l(),E(" ",e.unreadCount>99?"99+":e.unreadCount," ")}}function Ge(i,t){if(i&1){let e=T();m(0,Ve,1,0,"div",27),a(1,"div",28),g("click",function(r){let s=h(e).$implicit,x=d(2);return f(x.openChat(s.id,r))}),c(2,"app-avatar",29),a(3,"div",30)(4,"div",31)(5,"div",32),m(6,Fe,1,0,"i",33)(7,Re,1,0,"i",34),a(8,"h3",35),u(9),o()(),a(10,"div",36),m(11,ze,1,0,"i",37),a(12,"span"),u(13),ie(14,"shortTime"),o()()(),a(15,"div",38)(16,"p",39),m(17,Be,6,0,"span",40)(18,Qe,3,2),o(),a(19,"div",41),m(20,Oe,1,0,"i",42),m(21,qe,2,1,"span",43),o()()()()}if(i&2){let e=t.$implicit,n=d(2),r=n.chatService.getParticipant(e),s=n.chatService.getTypingUsersForChat(e.id);p(e===n.firstUnpinnedChat()&&n.pinnedChats().length>0?0:-1),l(),q("bg-telegram-primary-light",e.isPinned),l(),y("src",e.type==="direct"?r==null?null:r.avatarUrl:e.avatarUrl)("name",e.type==="direct"?(r==null?null:r.name)||"User":e.name||"Group")("isOnline",(r==null?null:r.isOnline)||!1),l(4),p(e.type==="channel"?6:e.type==="group"?7:-1),l(3),E(" ",e.type==="direct"?r==null?null:r.name:e.name," "),l(2),p((e.lastMessage==null?null:e.lastMessage.senderId)===n.chatService.currentUser().id?11:-1),l(2),D(ne(14,13,e.lastMessage==null?null:e.lastMessage.timestamp)),l(4),p(s.length>0?17:18),l(3),p(e.isPinned?20:-1),l(),p(e.unreadCount>0?21:-1)}}function Je(i,t){if(i&1&&(m(0,Pe,3,0,"div",25),V(1,Ge,22,15,null,null,ve)),i&2){let e=d();p(e.pinnedChats().length>0?0:-1),l(),F(e.filteredChats())}}function Ye(i,t){if(i&1&&c(0,"img",59),i&2){let e=d(2);y("src",e.profileDraft().avatarUrl,O)}}function We(i,t){if(i&1&&(a(0,"div",60),u(1),o()),i&2){let e=d(2);l(),E(" ",e.profileDraftInitial()," ")}}function Ze(i,t){if(i&1){let e=T();a(0,"div",71)(1,"button",72),g("click",function(){h(e);let r=d(2);return f(r.saveProfile())}),u(2," Save "),o()()}}function Ke(i,t){if(i&1){let e=T();a(0,"div",50),g("click",function(){h(e);let r=d();return f(r.closeProfileCard())}),a(1,"div",51),g("click",function(r){return h(e),f(r.stopPropagation())}),a(2,"div",52)(3,"div",53)(4,"span",54),u(5,"My Profile"),o(),a(6,"button",55),g("click",function(){h(e);let r=d();return f(r.closeProfileCard())}),c(7,"i",56),o()(),a(8,"div",57)(9,"button",58),g("click",function(){h(e);let r=d();return f(r.triggerProfileAvatarPicker())}),m(10,Ye,1,1,"img",59)(11,We,2,1,"div",60),o(),a(12,"input",61,4),g("change",function(r){h(e);let s=d();return f(s.onProfileAvatarSelected(r))}),o(),a(14,"button",62),g("click",function(){h(e);let r=d();return f(r.triggerProfileAvatarPicker())}),u(15," Change photo "),o(),a(16,"div",63)(17,"div",64),u(18),o(),a(19,"div",65),u(20),o()()(),a(21,"div",66)(22,"span",67),u(23,"Display Name"),o(),a(24,"input",68),g("input",function(r){h(e);let s=d();return f(s.onProfileInput("name",r))}),o()(),a(25,"div",66)(26,"span",67),u(27,"Username"),o(),a(28,"input",69),g("input",function(r){h(e);let s=d();return f(s.onProfileInput("username",r))}),o()(),a(29,"div",66)(30,"span",67),u(31,"Bio"),o(),a(32,"textarea",70),g("input",function(r){h(e);let s=d();return f(s.onProfileInput("bio",r))}),o()(),m(33,Ze,3,0,"div",71),o()()()}if(i&2){let e=d();l(10),p(e.profileDraft().avatarUrl?10:11),l(8),D(e.profileDraft().name||"My Account"),l(2),D("@"+(e.profileDraft().username||"my_account")),l(4),y("value",e.profileDraft().name),l(4),y("value",e.profileDraft().username),l(4),y("value",e.profileDraft().bio),l(),p(e.profileHasChanges()?33:-1)}}function Xe(i,t){i&1&&c(0,"span",83)}function et(i,t){if(i&1&&(a(0,"div",65),u(1),o()),i&2){let e=d().$implicit;l(),D("@"+e.username)}}function tt(i,t){if(i&1){let e=T();a(0,"div",88),g("click",function(){let r=h(e).$implicit,s=d(3);return f(s.selectUserForChat(r))}),c(1,"app-avatar",89),a(2,"div",30)(3,"div",90),u(4),o(),m(5,et,2,1,"div",65),o(),c(6,"i",91),o()}if(i&2){let e=t.$implicit,n=t.$index;q("border-t",n!==0)("border-gray-100",n!==0)("dark:border-gray-700/30",n!==0),l(),y("src",e.avatarUrl)("name",e.name)("isOnline",e.isOnline||!1),l(3),D(e.name),l(),p(e.username?5:-1)}}function it(i,t){if(i&1&&(a(0,"div",84),V(1,tt,7,11,"div",87,ve),o()),i&2){let e=d(2);l(),F(e.userSearchResults())}}function nt(i,t){i&1&&(a(0,"div",85),c(1,"i",92),a(2,"p",93),u(3,"\u06A9\u0627\u0631\u0628\u0631\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),o()())}function rt(i,t){i&1&&(a(0,"div",86),c(1,"i",94),a(2,"p",93),u(3,"\u0646\u0627\u0645 \u06CC\u0627 \u0646\u0627\u0645 \u06A9\u0627\u0631\u0628\u0631\u06CC \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F"),o(),a(4,"p",95),u(5,"\u062D\u062F\u0627\u0642\u0644 \u06F2 \u06A9\u0627\u0631\u0627\u06A9\u062A\u0631"),o()())}function at(i,t){if(i&1){let e=T();a(0,"div",73),g("click",function(){h(e);let r=d();return f(r.closeNewChatModal())}),a(1,"div",74),g("click",function(r){return h(e),f(r.stopPropagation())}),a(2,"div",75)(3,"div",76)(4,"span",77),c(5,"i",78),u(6," \u0686\u062A \u062C\u062F\u06CC\u062F "),o(),a(7,"button",55),g("click",function(){h(e);let r=d();return f(r.closeNewChatModal())}),c(8,"i",56),o()(),a(9,"div",79)(10,"div",80),c(11,"i",81),a(12,"input",82,5),g("input",function(r){h(e);let s=d();return f(s.onUserSearchInput(r))}),o(),m(14,Xe,1,0,"span",83),o()(),m(15,it,3,0,"div",84),m(16,nt,4,0,"div",85),m(17,rt,6,0,"div",86),o()()()}if(i&2){let e=d();l(12),y("value",e.userSearchQuery()),l(2),p(e.isSearchingUsers()?14:-1),l(),p(e.userSearchResults().length>0?15:-1),l(),p(e.userSearchQuery().length>=2&&!e.isSearchingUsers()&&e.userSearchResults().length===0?16:-1),l(),p(e.userSearchQuery().length<2&&e.userSearchResults().length===0?17:-1)}}var $=class i{constructor(){this.chatService=v(fe);this.api=v(ue);this.themeService=v(z);this.animation=v(pe);this.router=v(A);this.listContainer=R("listContainer");this.profileTrigger=R("profileTrigger");this.profileAvatarInput=R("profileAvatarInput");this.isLoading=b(!0);this.showFabMenu=b(!1);this.showProfileCard=b(!1);this.showNewChatModal=b(!1);this.searchQuery=b("");this.profileDraft=b({name:"",username:"",bio:"",avatarUrl:""});this.skeletonItems=[1,2,3,4,5,6];this.isClosingProfileCard=!1;this.userSearchQuery=b("");this.userSearchResults=b([]);this.isSearchingUsers=b(!1);this.searchDebounceTimer=null;this.isClosingNewChatModal=!1;this.nonArchivedChats=this.chatService.getNonArchivedChats();this.pinnedChats=k(()=>this.nonArchivedChats().filter(t=>t.isPinned));this.firstUnpinnedChat=k(()=>this.nonArchivedChats().find(e=>!e.isPinned));this.filteredChats=k(()=>{let t=this.searchQuery().toLowerCase(),e=this.nonArchivedChats();return t?e.filter(n=>(n.type==="direct"?this.chatService.getParticipant(n)?.name:n.name)?.toLowerCase().includes(t)||n.lastMessage?.text?.toLowerCase().includes(t)):e});this.currentThemeIcon=k(()=>this.themeService.getThemeInfo(this.themeService.currentTheme()).icon);this.currentUserInitial=k(()=>this.extractInitial(this.chatService.currentUser().name));this.profileDraftInitial=k(()=>this.extractInitial(this.profileDraft().name));this.profileHasChanges=k(()=>{let t=this.chatService.currentUser(),e=this.profileDraft();return this.profileSnapshotFromUser(t)!==this.profileSnapshotFromDraft(e)});this.themeService.init(),this.profileDraft.set(this.createDraftFromCurrentUser()),P(()=>{setTimeout(()=>{this.isLoading.set(!1),setTimeout(()=>{let t=this.listContainer()?.nativeElement;t&&this.animation.staggerListItems(t)},50)},600)})}cycleTheme(t){this.themeService.toggleTheme(t)}onSearchFocus(){}onSearchBlur(){}onSearchInput(t){this.searchQuery.set(t.target.value)}openProfileCard(t){this.showProfileCard()||(this.isClosingProfileCard=!1,this.profileDraft.set(this.createDraftFromCurrentUser()),this.showProfileCard.set(!0),setTimeout(()=>this.animateProfileCardIn(t.currentTarget),0))}closeProfileCard(){if(!this.showProfileCard()||this.isClosingProfileCard)return;this.isClosingProfileCard=!0;let t=document.getElementById("profile-overlay-backdrop"),e=document.getElementById("profile-overlay-card"),n=document.getElementById("profile-island-avatar"),r=this.profileTrigger()?.nativeElement;if(typeof gsap>"u"||!t||!e){this.showProfileCard.set(!1),this.isClosingProfileCard=!1;return}let s=gsap.timeline({defaults:{overwrite:"auto"},onComplete:()=>{this.showProfileCard.set(!1),this.isClosingProfileCard=!1}});if(n&&r){let x=n.getBoundingClientRect(),S=r.getBoundingClientRect(),C=n.cloneNode(!0);C.querySelectorAll("[id]").forEach(L=>L.removeAttribute("id")),C.style.position="fixed",C.style.left=`${x.left}px`,C.style.top=`${x.top}px`,C.style.width=`${x.width}px`,C.style.height=`${x.height}px`,C.style.pointerEvents="none",C.style.margin="0",C.style.zIndex="102",C.style.borderRadius="9999px",C.style.overflow="hidden",C.style.willChange="left, top, width, height, opacity",document.body.appendChild(C),s.to(e,{opacity:0,y:14,scale:.96,duration:.16,ease:"power2.in"},0).to(C,{left:S.left,top:S.top,width:S.width,height:S.height,opacity:0,duration:.2,ease:"power2.inOut",onComplete:()=>C.remove()},.04).to(t,{opacity:0,duration:.18,ease:"power1.out"},0);return}s.to(e,{opacity:0,y:14,scale:.96,duration:.16,ease:"power2.in"},0).to(t,{opacity:0,duration:.18,ease:"power1.out"},0)}onProfileInput(t,e){let n=e.target.value;this.profileDraft.update(r=>Q(H({},r),{[t]:n}))}triggerProfileAvatarPicker(){let t=this.profileAvatarInput()?.nativeElement;t&&t.click()}onProfileAvatarSelected(t){let e=t.target,n=e.files?.[0];if(!n)return;if(!n.type.startsWith("image/")){e.value="";return}let r=new FileReader;r.onload=()=>{let s=typeof r.result=="string"?r.result:"";s&&this.profileDraft.update(x=>Q(H({},x),{avatarUrl:s}))},r.readAsDataURL(n),e.value=""}saveProfile(){let t=this.profileDraft();this.chatService.updateCurrentUserProfile({name:t.name.trim()||this.chatService.currentUser().name,username:this.normalizeUsername(t.username),bio:t.bio.trim(),avatarUrl:t.avatarUrl?.trim()||this.chatService.currentUser().avatarUrl}),this.closeProfileCard()}openChat(t,e){this.animation.rippleEffect(e,e.currentTarget),setTimeout(()=>{this.router.navigate(["/chat",t])},150)}toggleFab(){this.openNewChatModal()}openNewChatModal(){this.showNewChatModal()||(this.isClosingNewChatModal=!1,this.userSearchQuery.set(""),this.userSearchResults.set([]),this.isSearchingUsers.set(!1),this.showNewChatModal.set(!0),setTimeout(()=>this.animateNewChatModalIn(),0))}closeNewChatModal(){if(!this.showNewChatModal()||this.isClosingNewChatModal)return;this.isClosingNewChatModal=!0;let t=document.getElementById("newchat-overlay-backdrop"),e=document.getElementById("newchat-overlay-card");if(typeof gsap>"u"||!t||!e){this.showNewChatModal.set(!1),this.isClosingNewChatModal=!1;return}gsap.timeline({defaults:{overwrite:"auto"},onComplete:()=>{this.showNewChatModal.set(!1),this.isClosingNewChatModal=!1}}).to(e,{opacity:0,y:14,scale:.96,duration:.16,ease:"power2.in"},0).to(t,{opacity:0,duration:.18,ease:"power1.out"},0)}onUserSearchInput(t){let e=t.target.value;if(this.userSearchQuery.set(e),this.searchDebounceTimer&&clearTimeout(this.searchDebounceTimer),e.trim().length<2){this.userSearchResults.set([]),this.isSearchingUsers.set(!1);return}this.isSearchingUsers.set(!0),this.searchDebounceTimer=setTimeout(()=>{this.api.searchUsers(e.trim()).subscribe({next:n=>{this.userSearchResults.set(n),this.isSearchingUsers.set(!1)},error:()=>{this.userSearchResults.set([]),this.isSearchingUsers.set(!1)}})},350)}async selectUserForChat(t){this.isSearchingUsers.set(!0);let e=await this.chatService.startDirectChat(t.id);this.isSearchingUsers.set(!1),e&&(this.showNewChatModal.set(!1),this.isClosingNewChatModal=!1,this.router.navigate(["/chat",e]))}animateNewChatModalIn(){let t=document.getElementById("newchat-overlay-backdrop"),e=document.getElementById("newchat-overlay-card"),n=document.getElementById("newchat-overlay-island");if(!t||!e||typeof gsap>"u")return;gsap.set(t,{opacity:0}),gsap.set(e,{opacity:0,y:24,scale:.94});let r=gsap.timeline({defaults:{overwrite:"auto"}});if(r.to(t,{opacity:1,duration:.22,ease:"power1.out"},0),r.to(e,{opacity:1,y:0,scale:1,duration:.28,ease:"back.out(1.25)"},.08),n){let s=n.querySelectorAll(".nc-field");s.length>0&&r.fromTo(s,{opacity:0,y:12},{opacity:1,y:0,duration:.22,stagger:.04,ease:"power2.out"},.18)}}createDraftFromCurrentUser(){let t=this.chatService.currentUser();return{name:t.name||"",username:t.username||this.normalizeUsername(t.name||"my_account"),bio:t.bio||"",avatarUrl:t.avatarUrl||""}}normalizeUsername(t){return t.replace(/^@+/,"").replace(/\s+/g,"_").toLowerCase()||"my_account"}profileSnapshotFromUser(t){return JSON.stringify({name:(t.name||"").trim(),username:this.normalizeUsername(t.username||t.name||""),bio:(t.bio||"").trim(),avatarUrl:(t.avatarUrl||"").trim()})}profileSnapshotFromDraft(t){return JSON.stringify({name:(t.name||"").trim(),username:this.normalizeUsername(t.username||t.name||""),bio:(t.bio||"").trim(),avatarUrl:(t.avatarUrl||"").trim()})}extractInitial(t){return(t||"U").trim().charAt(0).toUpperCase()||"U"}animateProfileCardIn(t){let e=document.getElementById("profile-overlay-backdrop"),n=document.getElementById("profile-overlay-card"),r=document.getElementById("profile-overlay-island"),s=document.getElementById("profile-island-avatar");if(!e||!n||!r||typeof gsap>"u")return;gsap.set(e,{opacity:0}),gsap.set(n,{opacity:0,y:24,scale:.94});let x=gsap.timeline({defaults:{overwrite:"auto"}});if(x.to(e,{opacity:1,duration:.22,ease:"power1.out"},0),t&&s){let C=t.getBoundingClientRect(),L=s.getBoundingClientRect(),_=t.cloneNode(!0);_.querySelectorAll("[id]").forEach(ye=>ye.removeAttribute("id")),_.style.position="fixed",_.style.left=`${C.left}px`,_.style.top=`${C.top}px`,_.style.width=`${C.width}px`,_.style.height=`${C.height}px`,_.style.pointerEvents="none",_.style.margin="0",_.style.zIndex="102",_.style.borderRadius="9999px",_.style.overflow="hidden",_.style.willChange="left, top, width, height, opacity",document.body.appendChild(_),x.to(_,{left:L.left,top:L.top,width:L.width,height:L.height,opacity:0,duration:.26,ease:"power3.out",onComplete:()=>_.remove()},.04)}x.to(n,{opacity:1,y:0,scale:1,duration:.28,ease:"back.out(1.25)"},.16);let S=r.querySelectorAll(".profile-field");S.length>0&&x.fromTo(S,{opacity:0,y:12},{opacity:1,y:0,duration:.22,stagger:.04,ease:"power2.out"},.24)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=M({type:i,selectors:[["app-chat-list"]],viewQuery:function(e,n){e&1&&W(n.listContainer,Le,5)(n.profileTrigger,Me,5)(n.profileAvatarInput,Ie,5),e&2&&Z(3)},decls:25,vars:6,consts:[["profileTrigger",""],["searchContainer",""],["searchIcon",""],["listContainer",""],["profileAvatarInput",""],["userSearchInput",""],["id","chat-list-container",1,"flex","flex-col","h-screen","bg-gray-50","dark:bg-telegram-bg","w-full"],[1,"safe-pt","px-4","pb-3","flex","items-center","justify-between","z-10","sticky","top-0","glass-strong","border-b","border-white/10"],[1,"flex","items-center","gap-3"],["aria-label","Open profile",1,"w-10","h-10","rounded-full","border","border-white/20","overflow-hidden","shadow-md","active:scale-90","transition-all",3,"click"],["alt","Profile",1,"w-full","h-full",2,"object-fit","cover",3,"src"],[1,"w-full","h-full","bg-telegram-primary","text-white","flex","items-center","justify-center","font-semibold"],[1,"flex","items-center","gap-1"],[1,"w-10","h-10","rounded-full","hover:bg-white/10","flex","items-center","justify-center","transition-all","active:scale-90",3,"click"],[1,"px-4","py-3","glass-strong"],[1,"relative"],[1,"ph","ph-magnifying-glass","absolute","left-3","top-1/2","-translate-y-1/2","text-gray-400","text-lg","transition-all"],["type","text","placeholder","Search",1,"w-full","bg-white/10","dark:bg-white/5","text-black","dark:text-white","rounded-xl","py-2.5","pl-10","pr-4","outline-none","transition-all","placeholder-gray-500","text-15","border","border-transparent","focus:border-telegram-primary/30","focus:bg-white/15","dark:focus:bg-white/10",3,"focus","blur","input"],[1,"flex-1","overflow-y-auto","no-scrollbar","pb-24","custom-scrollbar"],["id","profile-overlay-backdrop",1,"fixed","inset-0","z-[100]","flex","items-center","justify-center","p-4",2,"background","rgba(10, 14, 20, 0.42)","backdrop-filter","blur(12px)","-webkit-backdrop-filter","blur(12px)"],["id","newchat-overlay-backdrop",1,"fixed","inset-0","z-[100]","flex","items-center","justify-center","p-4",2,"background","rgba(10, 14, 20, 0.42)","backdrop-filter","blur(12px)","-webkit-backdrop-filter","blur(12px)"],[1,"fixed","bottom-6","right-6","z-20","flex","flex-col-reverse","items-center","gap-3"],[1,"w-14","h-14","bg-telegram-primary","text-white","rounded-full","shadow-lg","flex","items-center","justify-center","transition-all","active:scale-90","hover:shadow-xl","hover:shadow-telegram-primary/30",3,"click"],[1,"ph","ph-pencil-simple","text-2xl"],["variant","chat-item"],[1,"px-4","pt-2","pb-1"],[1,"text-xs","font-semibold","text-telegram-primary","uppercase","tracking-wider"],[1,"mx-4","my-1","h-px","bg-gradient-to-r","from-transparent","via-gray-300/40","dark:via-gray-600/30","to-transparent"],[1,"chat-item","flex","items-center","gap-3","px-4","py-3","cursor-pointer","relative","group","transition-all","duration-150","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","bg-white/90","dark:bg-telegram-surface","shadow-sm","hover:shadow-xl","hover:bg-white/10","active:bg-white/10",2,"min-height","72px","margin","0 0.75rem 0.55rem","backdrop-filter","blur(14px)","-webkit-backdrop-filter","blur(14px)",3,"click"],[3,"src","name","isOnline"],[1,"flex-1","min-w-0"],[1,"flex","justify-between","items-center","mb-0.5"],[1,"flex","items-center","gap-1.5","min-w-0"],[1,"ph-fill","ph-megaphone","text-telegram-primary","text-sm","shrink-0"],[1,"ph-fill","ph-users-three","text-telegram-primary","text-sm","shrink-0"],[1,"font-semibold","truncate","text-15"],[1,"flex","items-center","gap-1","shrink-0","text-xs","text-gray-500","dark:text-telegram-muted","tabular-nums"],[1,"ph-bold","ph-checks","text-telegram-primary","text-xs"],[1,"flex","justify-between","items-center"],[1,"text-13","text-gray-500","dark:text-telegram-muted","truncate","flex-1","mr-3"],[1,"text-telegram-primary","font-medium"],[1,"flex","items-center","gap-1.5","shrink-0"],[1,"ph-fill","ph-push-pin","text-gray-400","dark:text-telegram-muted","text-xs","transform","rotate-45"],[1,"bg-telegram-primary","text-white","text-2xs","font-bold","px-1.5","py-0.5","rounded-full","min-w-[1.25rem]","text-center","animate-bounce-in"],[1,"inline-flex","gap-0.5","ml-0.5"],[1,"w-1","h-1","rounded-full","bg-telegram-primary","animate-typing-dot-1","inline-block"],[1,"w-1","h-1","rounded-full","bg-telegram-primary","animate-typing-dot-2","inline-block"],[1,"w-1","h-1","rounded-full","bg-telegram-primary","animate-typing-dot-3","inline-block"],[1,"text-black","dark:text-white","opacity-70","mr-0.5"],[1,"text-telegram-primary","font-medium","mr-0.5"],["id","profile-overlay-backdrop",1,"fixed","inset-0","z-[100]","flex","items-center","justify-center","p-4",2,"background","rgba(10, 14, 20, 0.42)","backdrop-filter","blur(12px)","-webkit-backdrop-filter","blur(12px)",3,"click"],["id","profile-overlay-card",1,"w-full",2,"max-width","360px",3,"click"],["id","profile-overlay-island",1,"flex","flex-col","gap-3"],[1,"profile-field","flex","items-center","justify-between","bg-white/90","dark:bg-telegram-surface","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","px-3","py-2",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)"],[1,"text-sm","font-semibold","text-telegram-primary"],[1,"w-8","h-8","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700/50","transition-colors","active:scale-90",3,"click"],[1,"ph","ph-x","text-lg"],[1,"profile-field","flex","flex-col","items-center","gap-2","bg-white/90","dark:bg-telegram-surface","rounded-3xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","px-4","py-3",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)"],["type","button","id","profile-island-avatar",1,"w-16","h-16","rounded-full","overflow-hidden","border","border-gray-200","dark:border-gray-700","shadow-md","active:scale-95","transition-transform",3,"click"],["alt","Avatar preview",1,"w-full","h-full",2,"object-fit","cover",3,"src"],[1,"w-full","h-full","bg-telegram-primary","text-white","flex","items-center","justify-center","font-bold","text-xl"],["type","file","accept","image/*",1,"hidden",3,"change"],["type","button",1,"text-xs","text-telegram-primary","hover:opacity-70","transition-opacity",3,"click"],[1,"min-w-0","text-center"],[1,"font-semibold","truncate"],[1,"text-xs","text-telegram-muted","truncate"],[1,"profile-field","flex","flex-col","gap-1","bg-white/90","dark:bg-telegram-surface","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","px-3","py-2",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)"],[1,"text-xs","text-telegram-muted"],["placeholder","Your name",1,"w-full","bg-transparent","outline-none","text-sm",2,"border","none","box-shadow","none",3,"input","value"],["placeholder","username",1,"w-full","bg-transparent","outline-none","text-sm",2,"border","none","box-shadow","none",3,"input","value"],["rows","3","placeholder","Tell something about yourself",1,"w-full","bg-transparent","outline-none","resize-none","text-sm","no-scrollbar",2,"border","none","box-shadow","none",3,"input","value"],[1,"profile-save-island","bg-white/90","dark:bg-telegram-surface","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","p-2","animate-slide-up",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)"],[1,"w-full","py-2","rounded-xl","bg-telegram-primary","text-white","text-sm","shadow-md","hover:shadow-xl","transition-all","active:scale-95",3,"click"],["id","newchat-overlay-backdrop",1,"fixed","inset-0","z-[100]","flex","items-center","justify-center","p-4",2,"background","rgba(10, 14, 20, 0.42)","backdrop-filter","blur(12px)","-webkit-backdrop-filter","blur(12px)",3,"click"],["id","newchat-overlay-card",1,"w-full",2,"max-width","380px",3,"click"],["id","newchat-overlay-island",1,"flex","flex-col","gap-3"],[1,"nc-field","flex","items-center","justify-between","bg-white/90","dark:bg-telegram-surface","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","px-3","py-2",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)"],[1,"text-sm","font-semibold","text-telegram-primary","flex","items-center","gap-2"],[1,"ph","ph-chat-circle-dots","text-lg"],[1,"nc-field","bg-white/90","dark:bg-telegram-surface","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","px-3","py-2",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)"],[1,"relative","flex","items-center"],[1,"ph","ph-magnifying-glass","absolute","left-2","text-gray-400","text-lg"],["type","text","placeholder","\u062C\u0633\u062A\u062C\u0648\u06CC \u0646\u0627\u0645 \u06A9\u0627\u0631\u0628\u0631\u06CC...",1,"w-full","bg-transparent","outline-none","text-sm","py-1.5","pl-8","pr-2",2,"border","none","box-shadow","none","color","var(--tg-text)",3,"input","value"],[1,"w-4","h-4","border-2","border-telegram-primary","border-t-transparent","rounded-full","animate-spin","absolute","right-2"],[1,"nc-field","bg-white/90","dark:bg-telegram-surface","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","overflow-hidden",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)","max-height","280px","overflow-y","auto"],[1,"nc-field","bg-white/90","dark:bg-telegram-surface","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","px-4","py-6","text-center",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)"],[1,"nc-field","bg-white/90","dark:bg-telegram-surface","rounded-2xl","border","border-gray-200","dark:border-gray-700/50","shadow-md","px-4","py-5","text-center",2,"backdrop-filter","blur(16px)","-webkit-backdrop-filter","blur(16px)"],[1,"flex","items-center","gap-3","px-3","py-2.5","cursor-pointer","transition-all","hover:bg-gray-100/80","dark:hover:bg-gray-700/40","active:scale-[0.98]",3,"border-t","border-gray-100","dark:border-gray-700/30"],[1,"flex","items-center","gap-3","px-3","py-2.5","cursor-pointer","transition-all","hover:bg-gray-100/80","dark:hover:bg-gray-700/40","active:scale-[0.98]",3,"click"],["size","sm",3,"src","name","isOnline"],[1,"text-sm","font-semibold","truncate"],[1,"ph","ph-chat-circle","text-telegram-primary","text-xl","shrink-0"],[1,"ph","ph-users","text-3xl","text-gray-300","dark:text-gray-600","mb-2","block"],[1,"text-sm","text-telegram-muted"],[1,"ph","ph-at","text-3xl","text-gray-300","dark:text-gray-600","mb-2","block"],[1,"text-xs","text-telegram-muted","mt-1","opacity-60"]],template:function(e,n){if(e&1){let r=T();a(0,"div",6)(1,"header",7)(2,"div",8)(3,"button",9,0),g("click",function(x){return h(r),f(n.openProfileCard(x))}),m(5,Ue,1,1,"img",10)(6,De,2,1,"div",11),o()(),a(7,"div",12)(8,"button",13),g("click",function(x){return h(r),f(n.cycleTheme(x))}),c(9,"i"),o()()(),a(10,"div",14)(11,"div",15,1),c(13,"i",16,2),a(15,"input",17),g("focus",function(){return h(r),f(n.onSearchFocus())})("blur",function(){return h(r),f(n.onSearchBlur())})("input",function(x){return h(r),f(n.onSearchInput(x))}),o()()(),a(16,"div",18,3),m(18,Ne,2,0)(19,Je,3,1),o(),m(20,Ke,34,7,"div",19),m(21,at,18,5,"div",20),a(22,"div",21)(23,"button",22),g("click",function(){return h(r),f(n.openNewChatModal())}),c(24,"i",23),o()()()}e&2&&(l(5),p(n.chatService.currentUser().avatarUrl?5:6),l(4),K("ph "+n.currentThemeIcon()+" text-xl"),l(9),p(n.isLoading()?18:19),l(2),p(n.showProfileCard()?20:-1),l(),p(n.showNewChatModal()?21:-1))},dependencies:[ge,j,Ce],encapsulation:2})}};var G=async()=>{let i=v(N),t=v(A);return i.isLoading()&&await i.initialize(),i.isAuthenticated()?!0:(t.navigate(["/auth/login"]),!1)},J=async()=>{let i=v(N),t=v(A);return i.isLoading()&&await i.initialize(),i.isAuthenticated()?(t.navigate(["/"]),!1):!0};var be=[{path:"auth/login",loadComponent:()=>import("./chunk-3DUCQVWM.js").then(i=>i.LoginComponent),canActivate:[J]},{path:"auth/register",loadComponent:()=>import("./chunk-IKIQOUFB.js").then(i=>i.RegisterComponent),canActivate:[J]},{path:"",component:$,canActivate:[G]},{path:"chat/:id",loadComponent:()=>import("./chunk-P5XDTW7P.js").then(i=>i.ChatRoomComponent),canActivate:[G]},{path:"**",redirectTo:""}];oe(B,{providers:[re(),ce(be,me()),le(se())]}).catch(i=>console.error(i));
